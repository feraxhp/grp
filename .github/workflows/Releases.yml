on:
  workflow_dispatch:
    inputs:
      linux:
        description: "Run linux build?"
        required: true
        type: boolean
      windows:
          description: "Run windows build?"
          required: true
          type: boolean
  release:
    types:
      - created

env:
  CARGO_TERM_COLOR: always

jobs:
  build-linux:
    if: ${{ inputs.linux || inputs.linux == null }}
    permissions:
      contents: write
    name: 🖥️ Linux Build
    uses: ./.github/workflows/linux.yml

  build-windows:
    if: ${{ inputs.windows || inputs.windows == null }}
    permissions:
      contents: write
    name: 💻 Windows Build
    uses: ./.github/workflows/windows.yml
  
  publish-winget:
    if: ${{ inputs.windows || inputs.windows == null }}
    permissions:
      repository-projects: write
    name: 🔥 Publish on windows
    needs: build-windows
    uses: ./.github/workflows/winget.yml
